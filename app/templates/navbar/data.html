<!DOCTYPE html>
<html>
	<head>
        <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
        <meta content="utf-8" http-equiv="encoding">
		<script>
			$(function(){
				$("#tableModule").hide()
				$("#uploadModule").hide()

				getData(null, null, 0);
			});

			function getData(fromdate, todate, page){
				$.ajax({
					url: "/getData",
					type: "POST",
					data: {
						"fromdate": fromdate,
						"todate": todate,
						"page": page
					},
					success: function(data){
						if(data.length > 0){
							html = ""
							for(row of data){
								html += "<tr><td>"+row.id+"</td><td>"+row.timestamp+"</td><td>"+row.temperature+"</td><td>"+row.duration+"</td></tr>"
							} 
							$("#results").html(html)

							$("#tableModule").show()
							$("#uploadModule").hide()
						} else {
							$("#tableModule").hide()
							$("#uploadModule").show()
						}
					},
					error: function(data){
						if(data.responseJSON != null){
							alert(data.responseJSON.error);
						}
					}
				});
			}
		</script>
	</head>
	<body>
		<div id="tableModule" class="col-xs-12 col-md-10 col-md-offset-1" style="margin-top: 50px">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4>Table</h4>
				</div>
				<div class="panel-body">
					<div id='loader'></div>
					<div>
						<table class="table table-hover">
							<thead>
							<tr>
								<th>ID</th>
								<th>Timestamp</th>
								<th>Temperature</th>
								<th>Duration</th>
							</tr>
							</thead>
							<tbody id='results'>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>

		<div id="uploadModule" class="col-xs-12 col-md-10 col-md-offset-1" style="margin-top: 50px">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4>Upload CSV</h4>
				</div>
				<form method="post" enctype="multipart/form-data" action="/upload">
					<div class="panel-body">
						<div class="form-group">
							<input type="file" class="form-control" name="file" style="height: 100%" required>
						</div>
						<div class="modal-footer">
							<button id="uploadBtn" type="submit" class="btn btn-primary">Upload</button>
						</div>
					</div>
				</form>
			</div>
		</div>

		<div id="Modal" class="modal fade" role="dialog">
			<div class="modal-dialog">
				<div class="modal-content">
					<form id="changeResform">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"></h4>
						</div>
						<div class="modal-body">
							<input id="data-id" type="hidden"/>
							<div class="input-group">
								<span class="input-group-addon">Name</span>
								<input id="name" type="text" class="form-control" name="name" placeholder="Name" required/>
							</div>
							<div class="input-group">
								<span class="input-group-addon">Phone</span>
								<input id="phone" type="text" pattern="[0-9]{8}" class="form-control" name="phone" placeholder="Phone XXXXXXXX" required />
							</div>
							<div class="input-group">
								<span class="input-group-addon"># People</span>
								<input id="numPeople" type="number" class="form-control" name="numPeople" placeholder="Number of People" min="1" required />
							</div>
							<div class="input-group">
								<span class="input-group-addon">More Info</span>
								<textarea id="moreInfo" class="form-control" rows="5" placeholder="More Information" style="resize: vertical;"></textarea>
							</div>
							<div data-type="1">
								<div class="input-group">
									<span class="input-group-addon">Date</span>
									<input id="date1" type="text" class="form-control" name="date1" placeholder="Date" data-required="1" required />
								</div>
								<div class="input-group">
									<span class="input-group-addon">Table #</span>
									<input id="table1" type="text" class="form-control" name="table1" placeholder="Table #" />
								</div>
								<div class="input-group">
									<span class="input-group-addon">Price</span>
									<input id="price1" type="number" class="form-control" name="price1" placeholder="Price" value="5000" data-required="1" required />
								</div>
								<div class="input-group col-xs-offset-1 col-xs-10">
									<label class="checkbox-inline"><input id="withBBQ1" type="checkbox" name="withBBQ1" checked="checked"/>With BBQ</label>
								</div>
							</div>
							<div data-type="2">
								<div class="input-group">
									<span class="input-group-addon">Date From</span>
									<input id="fromdate2" type='text' class="form-control" name="fromdate2" placeholder="From Date" data-required="1" required />
								</div>
								<div class="input-group">
									<span class="input-group-addon">Date To</span>
									<input id="todate2" type="text" class="form-control" name="todate2" placeholder="To Date" data-required="1" required />
								</div>
								<div class="input-group">
									<span class="input-group-addon">Table #</span>
									<input id="table2" type="text" class="form-control" name="table2" placeholder="Table #" />
								</div>
								<div class="input-group">
									<span class="input-group-addon">Price</span>
									<input id="price2" type="number" class="form-control" name="price2" placeholder="Price" value="15000" data-required="1" required />
								</div>
								<div class="input-group col-xs-offset-1 col-xs-11">
									<label class="checkbox-inline"><input id="withBBQ2" type="checkbox" name="withBBQ2" checked="checked"/>With BBQ</label>
									<label class="checkbox-inline"><input id="withTent2" type="checkbox" name="withTent2" checked="checked"/>With Tent</label>
									<label class="checkbox-inline"><input id="withMatress2" type="checkbox" name="withMatress2" checked="checked"/>With Matress</label>
									<label class="checkbox-inline"><input id="withFood2" type="checkbox" name="withFood2" checked="checked"/>With Food</label>
								</div>
							</div>
							<div data-type="3">
								<div class="input-group">
									<span class="input-group-addon">Date</span>
									<input id="date3" type="text" class="form-control" name="date3" placeholder="Date" data-required="1" required />
								</div>
								<div class="input-group">
									<span class="input-group-addon">Table #</span>
									<input id="table3" type="text" class="form-control" name="table3" placeholder="Table #" />
								</div>
							</div>
							<br />
							<div class="input-group">
								<span class="input-group-addon">Added By</span>
								<div id="added-by" class="form-control">Added By</div>
							</div>
							<div class="input-group">
								<span class="input-group-addon">Added Date</span>
								<div id="added-date" class="form-control">Added Date</div>
							</div>
						</div>
						<div class="modal-footer">
							<button id="saveBtn" type="button" class="btn btn-primary">Save</button>
							<button id="deleteBtn" type="button" class="btn btn-danger">Delete</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>